<template>
  <b-container fluid>
    <div v-if="!isLoading">
      <h2>
        Vulnerability Data
      </h2>
      <b-row>
        <b-col cols="12" lg="6">
          <Navbar />
          <Description :descData="descData" />
        </b-col>
        <b-col cols="12" lg="6">
          <Chart :chartData="chartData" />
          <Table :tableData="tableData" />
        </b-col>
      </b-row>
    </div>

  </b-container>
</template>

<script>
// eslint-disable-next-line
import Chartist from 'chartist';
import Navbar from './navbar.vue';
import Description from './description.vue';
import Chart from './chart.vue';
import Table from './table.vue';

export default {
  components: {
    Navbar,
    Description,
    Chart,
    Table,
  },
  data() {
    return {
      isLoading: false,
      descData: [],
      chartData: null,
      tableData: [],
    };
  },
  watch: {
    $route() {
      this.getData();
    },
  },
  created() {
    this.getData();
  },
  methods: {
    getData() {
      this.isLoading = true;
      fetch(`/chart/${this.$route.params.id}`)
        .then((response) => response.json())
        .then((data) => {
          const { bullets, chart, list } = data;
          this.descData = bullets;
          this.chartData = chart;
          this.tableData = list;
          this.isLoading = false;
        });
    },
  },

};
</script>

<style lang='scss' scoped>

</style>
